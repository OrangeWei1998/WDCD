# WDCD
Weakly supervised Deep learning based Cloud Detection(WDCD)

## Title
Accurate cloud detection in high-resolution remote sensing imagery by weakly supervised deep learning

## Abstract
Cloud cover is a common and inevitable phenomenon that often hinders the usability of optical remote sensing (RS) image data and further harms the continuous cartography based on RS image interpretation. In the literature, the off-the-shelf cloud detection methods either require various hand-crafted features or utilize data-driven features using deep networks. As a whole, deep networks achieve much better performance than traditional methods using hand-crafted features. However, the current deep networks for cloud detection depend on massive pixel-level annotation labels, which cost lots of manual annotation labor. To alleviate the labor of annotating the pixel-level labels, this paper proposes a weakly supervised deep learning based cloud detection (WDCD) method using block-level labels indicating only the presence or the absence of cloud in one RS image block. In the training stage, a new global convolutional pooling (GCP) operation is proposed to enhance the ability of the feature map to represent useful information (e.g., spatial variance). In the testing stage, the trained deep networks are modified to generate the cloud activation map (CAM) via the local pooling pruning (LPP) strategy which prunes the local pooling layers of the deep networks trained in the training stage to improve the quality (e.g., spatial resolution) of CAM. Given one large RS image, it is cropped to multiple overlapping blocks by a sliding window, and then the CAM of each block is generated by the modified deep networks. Based on the correspondence between image blocks and CAMs, multiple corresponding CAMs are collected to mosaic the CAM of the large image. By segmenting the CAM using a statistical threshold against clear-sky surface, the pixel-level cloud mask of the testing image can be obtained. To verify the effectiveness of our proposed WDCD method, we collect a new global dataset where the training dataset contains over 200,000 RS image blocks with block-level labels from GaoFen-1 imagery and the validation and testing datasets contain 25 large RS image with pixel-level annotation labels composed of the GaoFen-1 and ZiYuan-3 imagery. Even under this extremely weak supervision, our proposed WDCD method could achieve excellent cloud detection performance with the average overall accuracy (OA) as high as 95.4%. Extensive experiments demonstrate that our proposed WDCD method obviously outperforms the state-of-the-art methods. 

## Code
Coming soon!

## Dataset
The block-level RS image dataset for weakly supervised cloud detection can be downloaded via [BaiduNetDisk(Access Code:hr1l)](https://pan.baidu.com/s/13i3jMrMPBELc-w3tzhXbpQ).
