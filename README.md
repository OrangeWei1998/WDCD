# WDCD
Weakly supervised Deep learning based Cloud Detection(WDCD)

## Title
Accurate cloud detection in high-resolution remote sensing imagery by weakly supervised deep learning

## Abstract
Cloud cover is a common and inevitable phenomenon that often hinders the usability of optical remote sensing (RS) image data and further interferes with continuous cartography based on RS image interpretation. In the literature, the off-the-shelf cloud detection methods either require various hand-crafted features or utilize data-driven features using deep networks. Overall, deep networks achieve much better performance than traditional methods using hand-crafted features. However, the current deep networks used for cloud detection depend on massive pixel-level annotation labels, which require a great deal of manual annotation labor. To reduce the labor needed for annotating the pixel-level labels, this paper proposes a weakly supervised deep learning-based cloud detection (WDCD) method using block-level labels indicating only the presence or the absence of cloud in one RS image block. In the training phase, a new global convolutional pooling (GCP) operation is proposed to enhance the ability of the feature map to represent useful information (e.g., spatial variance). In the testing phase, the trained deep networks are modified to generate the cloud activation map (CAM) via the local pooling pruning (LPP) strategy, which prunes the local pooling layers of the deep networks that are trained in the training phase to improve the quality (e.g., spatial resolution) of CAM. One large RS image is cropped into multiple overlapping blocks by a sliding window, and then the CAM of each block is generated by the modified deep networks. Based on the correspondence between the image blocks and CAMs, multiple corresponding CAMs are collected to mosaic the CAM of the large image. By segmenting the CAM using a statistical threshold against a clear-sky surface, the pixel-level cloud mask of the testing image can be obtained. To verify the effectiveness of our proposed WDCD method, we collected a new global dataset, for which the training dataset contains over 200,000 RS image blocks with block-level labels from 622 large GaoFen-1 images from all over the world; the validation dataset contains 5 large GaoFen-1 images with pixel-level annotation labels, and the testing dataset contains 25 large GaoFen-1 and ZiYuan-3 images with pixel-level annotation labels. Even under the extremely weak supervision, our proposed WDCD method could achieve excellent cloud detection performance with an overall accuracy (OA) as high as 96.66%. Extensive experiments demonstrated that our proposed WDCD method obviously outperforms the state-of-the-art methods.

## Dataset
The block-level RS image dataset for weakly supervised cloud detection can be downloaded via [The project website](https://skyearth.org/publication/project/WDCD/) or [BaiduNetDisk(Access Code:hr1l)](https://pan.baidu.com/s/13i3jMrMPBELc-w3tzhXbpQ).

## Citation
If you use the cloud dataset in your research, please cite the following reference:

**Li, Y., Chen W., Zhang Y., Tao C., Xiao R., and Tan Y., Accurate cloud detection in high-resolution remote sensing imagery by weakly supervised deep learning, Remote Sensing of Environment, (2020), [doi.org/10.1016/j.rse.2020.112045](https://doi.org/10.1016/j.rse.2020.112045).**
